### [CVE-2021-4034](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-4034)
![](https://img.shields.io/static/v1?label=Product&message=polkit&color=blue)
![](https://img.shields.io/static/v1?label=Version&message=n%2Fa&color=blue)
![](https://img.shields.io/static/v1?label=Vulnerability&message=(CWE-787%7CCWE-125)&color=brighgreen)

### Description

A local privilege escalation vulnerability was found on polkit's pkexec utility. The pkexec application is a setuid tool designed to allow unprivileged users to run commands as privileged users according predefined policies. The current version of pkexec doesn't handle the calling parameters count correctly and ends trying to execute environment variables as commands. An attacker can leverage this by crafting environment variables in such a way it'll induce pkexec to execute arbitrary code. When successfully executed the attack can cause a local privilege escalation given unprivileged users administrative rights on the target machine.

### POC

#### Reference
- http://packetstormsecurity.com/files/166196/Polkit-pkexec-Local-Privilege-Escalation.html
- http://packetstormsecurity.com/files/166200/Polkit-pkexec-Privilege-Escalation.html

#### Github
- https://github.com/0xsyr0/OSCP
- https://github.com/ARGOeu-Metrics/secmon-probes
- https://github.com/ARGOeu/secmon-probes
- https://github.com/ARPSyndicate/cvemon
- https://github.com/Al1ex/CVE-2021-4034
- https://github.com/Al1ex/LinuxEelvation
- https://github.com/Almorabea/pkexec-exploit
- https://github.com/An00bRektn/CVE-2021-4034
- https://github.com/AnastasiaLomova/PR1
- https://github.com/AnastasiaLomova/PR1.1
- https://github.com/Astrogeorgeonethree/Starred2
- https://github.com/Awrrays/Pentest-Tips
- https://github.com/BachoSeven/stellestelline
- https://github.com/C7H10N2/Hackergame2022_Writeup
- https://github.com/CYB3RK1D/CVE-2021-4034-POC
- https://github.com/DavidSerre/Pwnkit
- https://github.com/DosAmp/pkwned
- https://github.com/EGI-Federation/SVG-advisories
- https://github.com/Enes4xd/Enes4xd
- https://github.com/GibzB/THM-Captured-Rooms
- https://github.com/H3arn/hackergame-2022-writeup
- https://github.com/HadessCS/Awesome-Privilege-Escalation
- https://github.com/Hiimsonkul/Hiimsonkul
- https://github.com/IBM-Cloud/vpc-ha-iac
- https://github.com/ITMarcin2211/Polkit-s-Pkexec-CVE-2021-4034
- https://github.com/Ignitetechnologies/Linux-Privilege-Escalation
- https://github.com/JERRY123S/all-poc
- https://github.com/Kirill89/CVE-2021-4034
- https://github.com/LebJe/awesome-stars
- https://github.com/Ly0nt4r/OSCP
- https://github.com/MedKH1684/Pwnkit-CVE-2021-4034
- https://github.com/Meowmycks/OSCPprep-Cute
- https://github.com/Meowmycks/OSCPprep-Sar
- https://github.com/Meowmycks/OSCPprep-hackme1
- https://github.com/Mr-xn/Penetration_Testing_POC
- https://github.com/N1et/CVE-2021-4034
- https://github.com/Nero22k/CVE-2021-4034
- https://github.com/Nickguitar/YAPS
- https://github.com/Nosferatuvjr/PwnKit
- https://github.com/PenTestical/linpwn
- https://github.com/Pr0f3ssor/CVE-2021-4034-Pwnkit
- https://github.com/Rezilion/mi-x
- https://github.com/SYRTI/POC_to_review
- https://github.com/SnailDev/github-hot-hub
- https://github.com/Somchandra17/Privilege-Escalation-For-Linux
- https://github.com/SugarP1g/LearningSecurity
- https://github.com/Threekiii/Awesome-POC
- https://github.com/Y3A/CVE-2021-4034
- https://github.com/Yakumwamba/POC-CVE-2021-4034
- https://github.com/YgorAlberto/Ethical-Hacker
- https://github.com/ZWDeJun/ZWDeJun
- https://github.com/aasphixie/aasphixie.github.io
- https://github.com/anquanscan/sec-tools
- https://github.com/arthepsy/CVE-2021-4034
- https://github.com/arveske/Github-language-trends
- https://github.com/ashishlaxkar16/vulnerabilities
- https://github.com/ashutoshrohilla/CVE-2021-4034
- https://github.com/aus-mate/CVE-2021-4034-POC
- https://github.com/ayypril/CVE-2021-4034
- https://github.com/b1n4ryj4n/awesome-stars
- https://github.com/backloop-biz/CVE_checks
- https://github.com/bakhtiyarsierad/CVE-2021-4034-bug-root
- https://github.com/bc29ea3c101054baa1429ffc2edba4ae/sigma_detection_rules
- https://github.com/binganao/vulns-2022
- https://github.com/bollwarm/SecToolSet
- https://github.com/brootware/awesome-cyber-security-university
- https://github.com/brootware/cyber-security-university
- https://github.com/c0br40x/test
- https://github.com/c3c/CVE-2021-4034
- https://github.com/cdrclbrs/pwnkit
- https://github.com/chenaotian/CVE-2021-4034
- https://github.com/chenaotian/CVE-2022-0185
- https://github.com/codiobert/pwnkit-scanner
- https://github.com/cr0ss2018/cr0ss2018
- https://github.com/crac-learning/CVE-analysis-reports
- https://github.com/cyberanand1337x/bug-bounty-2022
- https://github.com/d-rn/vulBox
- https://github.com/daphnetd/daphnetd
- https://github.com/deoxykev/CVE-2021-4034-Rust
- https://github.com/e-hakson/OSCP
- https://github.com/edsonjt81/CVE-2021-4034-Linux
- https://github.com/edsonjt81/Linux-Privilege-Escalation
- https://github.com/edsonjt81/PwnKit
- https://github.com/eljosep/OSCP-Guide
- https://github.com/ezelnur6327/Enes4xd
- https://github.com/ezelnur6327/ezelnur6327
- https://github.com/fenipr/Shibboleth
- https://github.com/grng3r/rs_exploits
- https://github.com/hackingyseguridad/CVE-2021-4034
- https://github.com/hktalent/TOP
- https://github.com/hohn/codeql-sample-polkit
- https://github.com/hugs42/infosec
- https://github.com/jenriquezv/OSCP-Cheat-Sheets
- https://github.com/jm33-m0/go-lpe
- https://github.com/jostmart/-CVE-2021-4034
- https://github.com/kaosagnt/ansible-everyday
- https://github.com/kotikjaroslav/sigma_detection_rules
- https://github.com/learner-ing/changeTools
- https://github.com/legovaer/my-awesome-stars
- https://github.com/lewiswu1209/sif
- https://github.com/liamg/traitor
- https://github.com/lonnyzhang423/github-hot-hub
- https://github.com/luckythandel/CVE-2021-4034
- https://github.com/ly4k/PwnKit
- https://github.com/maxgfr/awesome-stars
- https://github.com/merlinepedra/TRAITOR
- https://github.com/merlinepedra25/TRAITOR
- https://github.com/mondoohq/demos
- https://github.com/n1sh1th/CVE-POC
- https://github.com/nobelh/CVE-2021-4034
- https://github.com/nobelh/nobelh.github.archive
- https://github.com/nobelh/nobelh.github.io
- https://github.com/nomi-sec/PoC-in-GitHub
- https://github.com/open-source-agenda/new-open-source-projects
- https://github.com/oreosec/pwnkit
- https://github.com/p1ay8y3ar/cve_monitor
- https://github.com/pancham1305/YearOfTheRabbit-thm
- https://github.com/pen4uin/awesome-vulnerability-research
- https://github.com/pen4uin/vulnerability-research
- https://github.com/pen4uin/vulnerability-research-list
- https://github.com/ponsfrilus/ponsfrilus
- https://github.com/puckiestyle/CVE-2021-4034
- https://github.com/rayheffer/CVE-2021-4034
- https://github.com/rhysmcneill/CVE-2021-403
- https://github.com/robemmerson/CVE-2021-4034
- https://github.com/san3ncrypt3d/CVE-2021-4034-POC
- https://github.com/sanchez-anthony/ansible_pwnkit_mitigation
- https://github.com/sarutobi12/sarutobi12
- https://github.com/scent2d/PoC-CVE-2021-4034
- https://github.com/sereok3/buffer-overflow-writeups
- https://github.com/slange-dev/slange-dev
- https://github.com/sofire/polkit-0.96-CVE-2021-4034
- https://github.com/soosmile/POC
- https://github.com/sunny0day/CVE-2021-4034
- https://github.com/szaszm/pwnkit
- https://github.com/tahaafarooq/poppy
- https://github.com/taielab/awesome-hacking-lists
- https://github.com/tanjiti/sec_profile
- https://github.com/trhacknon/Pocingit
- https://github.com/trhacknon/PwnKit
- https://github.com/tunjing789/Engineer-CTF
- https://github.com/uhub/awesome-c
- https://github.com/whalehub/awesome-stars
- https://github.com/winterwolf32/CVE-S---Penetration_Testing_POC-
- https://github.com/wongwaituck/CVE-2021-4034
- https://github.com/xymeng16/security
- https://github.com/z3dc0ps/awesome-linux-exploits
- https://github.com/zetaemme/b4d_p3n6u1n
- https://github.com/ziadsaleemi/polkit_CVE-2021-4034

